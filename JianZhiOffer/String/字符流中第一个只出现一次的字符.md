# 题目

请实现一个函数用来找出字符流中第一个只出现一次的字符。例如，当从字符流中只读出前两个字符 "go" 时，第一个只出现一次的字符是 'g'；当从该字符流中读出前6个字符 "google" 时，第一个只出现一次的字符是 'l'。

# 思路

可以在类中使用一个 StringBuilder 记录字符流，每次 insert 时向 sb 中 append。当需要找出字符流中第一个不重复的字符时，根据题目 “第一个只出现一次的字符” 中的方法，先遍历一遍 sb，用一个 map 记录 sb 中每个字符的出现次数，然后再遍历一遍 sb，根据 map 找到第一个不重复的字符。但是使用这种方法，当字符流中的字符很多时，每次调用 firstAppearingOnce() 找当前字符流中第一个不重复的字符时都要遍历一遍字符流，那么时间开销会很大。更好的做法是用一个数组 occurrence 记录当前字符流中各个字符的出现情况，occurrence 的大小为256。初始时，occurrence 中的每个元素置为-1，表示所有的字符都还未出现过。之后每次 insert 一个字符时，设当前字符的 ASCII 码为 i，如果当前字符还未出现过，则将当前字符在字符流中的下标 index 赋给occurrence[i]；如果当前字符已经出现过，则我们就不需要考虑这个字符了，约定把-2赋给 occurrence[i]。在函数 firstAppearingOnce() 中，我们遍历 occurrence，并用 ch 和 minIndex 记录第一个只出现一次的字符和它的下标。遍历结束返回 ch 即可。

总结 occurrence[i] 各个值的含义如下：

* occurrence[i] = -1：ASCII 码为 i 的字符还未出现过

* occurrence[i] >= 0：ASCII 码为 i 的字符出现了一次，第一次出现的位置为 occurrence[i]

* occurrence[i] = -2：ASCII 码为 i 的字符出现了多次

```java
class CharacterStream {

    private int[] occurrence;	// 记录字符流中每个字符的出现情况
    private int index;	// 字符流中字符的个数

    public CharacterStream() {
        occurrence = new int[256];
        for (int i = 0; i < 256; i++) {
            occurrence[i] = -1;
        }
        index = 0;
    }

    public void insert(char c) {
        if (occurrence[c] == -1) {	// 如果当前字符还未出现过，将当前字符的下标赋给occurrence[c]
            occurrence[c] = index++;
        } else if (occurrence[c] >= 0) {	// 如果当前字符已经出现过，将occurrence[c]赋为-2
            occurrence[c] = -2;
        }
    }

    public char firstAppearingOnce() {
        char c = '#';
        int minIndex = Integer.MAX_VALUE;
        for (int i = 0; i < 256; i++) {
            if (occurrence[i] >= 0 && occurrence[i] < minIndex) {
                c = (char) i;
                minIndex = occurrence[i];
            }
        }
        return c;	// 如果当前字符流中不存在只出现一次的字符，返回'#'
    }
}
```

