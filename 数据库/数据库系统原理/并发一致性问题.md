# 并发一致性问题

在并发环境下，事务的隔离性很难保证，因此会出现很多并发一致性问题。

## 丢失修改

T1 和 T2 两个事务都对一个数据进行修改，T1 先修改，T2 随后修改，T2 的修改覆盖了 T1 的修改。

![img](https://cyc2018.github.io/CS-Notes/pics/26a7c9df-22f6-4df4-845a-745c053ab2e5.jpg)

## 读脏数据

T1 修改一个数据，T2 随后读取这个数据。如果 T1 撤销了这次修改，那么 T2 读取的数据是脏数据。

![img](https://cyc2018.github.io/CS-Notes/pics/bab0fba6-38e4-45f7-b34d-3edaad43810f.jpg)

## 不可重复读

T2 读取一个数据，T1 对该数据做了修改。如果 T2 再次读取这个数据，此时读取的结果和第一次读取的结果不同。

![img](https://cyc2018.github.io/CS-Notes/pics/43bf0957-0386-4c09-9ad7-e163c5b62559.jpg)

## 幻读

T1 读取某个范围的数据，T2 在这个范围内插入新的数据，T1 再次读取这个范围的数据，此时读取的结果和和第一次读取的结果不同。

![img](https://cyc2018.github.io/CS-Notes/pics/2959e455-e6cb-4461-aeb3-e319fe5c41db.jpg)

------

产生并发不一致性问题主要原因是破坏了事务的隔离性，解决方法是通过并发控制来保证隔离性。并发控制可以通过封锁来实现，但是封锁操作需要用户自己控制，相当复杂。数据库管理系统提供了事务的隔离级别，让用户以一种更轻松的方式处理并发一致性问题。